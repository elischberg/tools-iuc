<?xml version="1.0"?>
<macros>
    <token name="@TOOL_VERSION@">1.1</token>
    <token name="@VERSION_SUFFIX@">0</token>
    <xml name="main_parameters">
        <conditional name="main_params">
            <param name="specify_how" type="select" label="How to set the main parameters, threshold for consensus nucleotides and max ambiguous nts per primer?">
                <option value="set_n_ambig">Specify max ambiguous nts, estimate suitable threshold</option>
                <option value="set_threshold">Specify threshold, estimate max ambiguous nts</option>
                <option value="set_both">Specify values for both</option>
            </param>
            <when value="set_n_ambig">
                <param argument="--n-ambig" type="integer" min="0" value="2" label="Maximum number of ambiguous nucleotides per primer to be tolerated (default: 2)" />
                <yield />
            </when>
            <when value="set_threshold">
                <param argument="--threshold" type="float" min="0.0" max="1.0" value="0.8" label="Threshold for consensus nucleotides" />
            </when>
            <when value="set_both">
                <param argument="--threshold" type="float" min="0.0" max="1.0" value="0.8" label="Threshold for consensus nucleotides" />
                <param argument="--n-ambig" type="integer" min="0" value="2" label="Maximum number of ambiguous nucleotides per primer to be tolerated" />
                <yield />
            </when>
        </conditional>
    </xml>
    <xml name="blast_options">
        <section name="db_sec" title="BLAST Database" expanded="false">
            <conditional name="db_cond">
                <param name="db_check" type="select" label="Extra Database?">
                    <option value="">No extra Database.</option>
                    <option value="expand">Use additional BLAST database. </option>
                </param>
                <when value="" />
                <when value="expand">
                    <param argument="--database" type="data" optional="true" format="blastdp" label="BLAST database" help="You can create this DB with the makeblastdb tool." />
                    <conditional name="blast_advanced_cond">
                        <param name="blast_advanced" type="select" label="Advanced Blast Settings?">
                            <option value="">No advanced settings.</option>
                            <option value="yes">More settings needed.</option>
                        </param>
                        <when value=""/>
                        <when value="yes">
                            <section name="blast_search" title="BLAST settings for query search">
                                <param name="evalue" type="integer" min="1000" max="10000" value="5000" label="BLAST evalue"/>
                                <param name="reward" type="integer" min="0" max="10" value="1" label="BLAST reward"/>
                                <param name="penalty" type="integer" min="-5" max="5" value="-1" label="BLAST penalty"/>
                                <param name="gapopen" type="integer" min="0" max="10" value="2" label="BLAST gapopen"/>
                                <param name="gapextend" type="integer" min="0" max="10" value="1" label="BLAST gapextend"/>
                            </section>
                            <param name="BLAST_MAX_DIFF" type="float" min="0" max="1" value="0.8" label="Maximal allowed %-Difference BLAST Hit - Primer" />
                            <param name="BLAST_SIZE_MULTI" type="float" min="0" max="10" value="2" label="Multiplier for the max_amp size of off targets (in relation to max amp size)" />
                            <param name="BLAST_PENALTY" type="integer" min="0" max="100" value="50" label="Amplicon penalty increase" help="Considered only if no other possibilities." />
                        </when>
                    </conditional>
                </when>
            </conditional>
        </section>
    </xml>
    <xml name="advanced_general_parameters">
        <section name="basic_primer_params" title="Basic Primer Parameter" expanded="false">
            <param name="PRIMER_TMP_min" type="integer" min="0" max="100" value="57" label="Minimum melting temperatur"/>
            <param name="PRIMER_TMP_max" type="integer" min="0" max="100" value="63" label="Maximum melting temperatur"/>
            <param name="PRIMER_TMP_opt" type="integer" min="0" max="100" value="60" label="Optimum melting temperatur"/>
            <param name="PRIMER_GC_RANGE_min" type="integer" min="0" max="100" value="35" label="Minimum GC Range" />
            <param name="PRIMER_GC_RANGE_max" type="integer" min="0" max="100" value="65" label="Maximum GC Range" />
            <param name="PRIMER_GC_RANGE_opt" type="integer" min="0" max="100" value="50" label="Optimum GC Range" />
            <param name="PRIMER_SIZES_min" type="integer" min="0" max="100" value="18" label="Minimum Primer size" />
            <param name="PRIMER_SIZES_max" type="integer" min="0" max="100" value="24" label="Maximum Primer size" />
            <param name="PRIMER_SIZES_opt" type="integer" min="0" max="100" value="21" label="Optimum Primer size" />
            <param name="PRIMER_MAX_POLYX" type="integer" min="0" max="10" value="3" label="Max number of polyx repeats." />
            <param name="PRIMER_MAX_DINUC_REPEATS" type="integer" min="0" max="10" value="3" label="Max number of dinucleotide repeats." />
            <param name="PRIMER_HAIRPIN" type="integer" min="0" max="100" value="47" label="Max melting temp for secondary structure." />
            <param name="PRIMER_GC_END_min" type="integer" min="0" max="5" value="0" label="Minimum GCs in the last 5 bases of the 3' end" />
            <param name="PRIMER_GC_END_max" type="integer" min="0" max="5" value="4" label="Maximum GCs in the last 5 bases of the 3' end" />
            <param name="PRIMER_MIN_3_WITHOUT_AMB" type="integer" min="0" max="10" value="3" label="Min length of 3' without ambiguous charaters." />
            <param name="PRIMER_MAX_DIMER_TMP" type="integer" min="0" max="100" value="47" label="Max melting temp for dimers (homo- or heterodimers)." />
        </section>
        <section name="pcr_params" title="PCR Parameters" expanded="false">
            <param name="PCR_MV_CONC" type="float" min="1" max="300" value="100" label="Monovalent cations in mM" />
            <param name="PCR_DV_CONC" type="float" min="1" max="100" value="2" label="Divalent cations in mM." />
            <param name="PCR_DNTP_CONC" type="float" min="0" max="10" value="0.8" label="dntp concentration in mM." />
            <param name="PCR_DNA_CONC" type="float" min="0" max="100" value="15" label="Primer concentration in nM." />
        </section>
        <section name="multiple_penalties" title="Multipliers for primer and qpcr probe penalties" expanded="false">
            <param name="PRIMER_TM_PENALTY" type="integer" min="0" max="10" value="2" label="Temperature penalty." />
            <param name="PRIMER_GC_PENALTY" type="float" min="0" max="1" value="0.2" label="GC penalty." />
            <param name="PRIMER_SIZE_PENALTY" type="float" min="0" max="1" value="0.5" label="Size penalty." />
            <param name="PRIMER_MAX_BASE_PENALTY" type="integer" min="0" max="100" value="8" label="Max base penalty for a primer." />
            <!--param name="PRIMER_3_PENALTY" type="select" optional="true" label="Penalties for 3' mismatches (32, 16, 8, 4, 2)." /-->
            <param name="PRIMER_PERMUTATION_PENALTY" type="float" min="0" max="10" value="0.1" label="Penalty for the number of permutations." />
        </section>
    </xml>
    <xml name="g_out">
        <section name="g_out_s" title="General Outputs" expanded="true">
            <param name="g_out" type="select" multiple="true" optional="false" label="Which general outputs would you like to obtain?">
                <option value="ambiguous_consensus" selected="true" >The consensus sequence containing ambiguous nucleotides.</option>
                <option value="amplicon_plot" selected="true">A nice overview for your final amplicon design.</option>
                <option value="amplicons" selected="true">A bed file showing the amplicon location compared to the consensus sequence.</option>
                <option value="per_base_mismatches">Barplot of the percent mismatches at each nucleotide position of the primer.</option>
                <option value="primers" selected="true">A bed file with the primer locations. Includes the primer penalty. The lower, the better.</option>
                <option value="varvamp_log">Log file.</option>
                <option value="alignment_cleaned">The preprocessed alignment.</option>
                <option value="majority_consensus">Consensus sequence that does not have ambiguous characters but instead has the most prevalent nucleotide at each position.</option>
                <option value="primer_regions">A bed file showing the location of the potential regions of the consensus sequence that were evaluated for primers.</option>
            </param>
        </section>
    </xml>
</macros>

